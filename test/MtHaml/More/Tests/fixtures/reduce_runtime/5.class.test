--FILE--
<?php

$widget=array('type'=>3);
$item=array('type'=>'car','urgency'=>'loop','number'=>3,'is_empty'=>false);
$item2=array('type'=>'car','urgency'=>'loop','number'=>3,'is_empty'=>true);
$sortdir='desc';
$sortcol=$item;

$compiled =  MtHaml\More\Entry::compilePhpMoreHaml( $parts['HAML'],array('enable_escaper'=>false),array(
    'reduce_runtime' => true,
));
$compiled_file=$file.'..php';
file_put_contents($compiled_file,$compiled);
include $compiled_file;
--HAML--
%span.ok(class="widget_#{$widget['type']}")
.item{:class => $item['is_empty'] ? "empty":null}
.item{:class => $item2['is_empty'] ? "empty":null}
#item{:class => $item['is_empty'] ? "empty":null}
%div.add{:class => [$item['type'], $item == $sortcol ? array('sort', $sortdir):null] } Contents
--EXPECT--
<span class="ok widget_3"></span>
<div class="item"></div>
<div class="item empty"></div>
<div id="item"></div>
<div class="add car sort desc">Contents</div>

--EXPECT_PHP--
<span<?php $__mthamlmore_attri_value= htmlspecialchars(implode(' ',array_filter(array('ok',('widget_' . ($widget['type']))),function($v){return is_null($v)?false:true;})), ENT_QUOTES, 'UTF-8');
if($__mthamlmore_attri_value!=="") echo ' class="'.$__mthamlmore_attri_value.'"' ; ?>></span>
<div<?php $__mthamlmore_attri_value= htmlspecialchars(implode(' ',array_filter(array('item',($item['is_empty'] ? "empty":null)),function($v){return is_null($v)?false:true;})), ENT_QUOTES, 'UTF-8');
if($__mthamlmore_attri_value!=="") echo ' class="'.$__mthamlmore_attri_value.'"' ; ?>></div>
<div<?php $__mthamlmore_attri_value= htmlspecialchars(implode(' ',array_filter(array('item',($item2['is_empty'] ? "empty":null)),function($v){return is_null($v)?false:true;})), ENT_QUOTES, 'UTF-8');
if($__mthamlmore_attri_value!=="") echo ' class="'.$__mthamlmore_attri_value.'"' ; ?>></div>
<div id="item"<?php $__mthamlmore_attri_value= htmlspecialchars(implode(' ',array_filter(array(($item['is_empty'] ? "empty":null)),function($v){return is_null($v)?false:true;})), ENT_QUOTES, 'UTF-8');
if($__mthamlmore_attri_value!=="") echo ' class="'.$__mthamlmore_attri_value.'"' ; ?>></div>
<div<?php $__mthamlmore_attri_value= htmlspecialchars(implode(' ',array_filter(iterator_to_array(new RecursiveIteratorIterator( new RecursiveArrayIterator( array('add',$item['type'], $item == $sortcol ? array('sort', $sortdir):null) )), FALSE),function($v){return is_null($v)?false:true;})), ENT_QUOTES, 'UTF-8');
if($__mthamlmore_attri_value!=="") echo ' class="'.$__mthamlmore_attri_value.'"' ; ?>>Contents</div>

